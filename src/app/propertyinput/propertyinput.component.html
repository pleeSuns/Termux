<app-splitter [persistId]="'property-inspector'"
  [edge]="'left'"
  [min]="200">
</app-splitter>
<ng-container *ngIf="(this.propertyInputModel$ | async) as model">
  <!-- No models selected. -->
  <div *ngIf="model.numSelections === 0"
    class="spi-empty"
    fxFlex>
    Select something to edit its properties
  </div>
  <!-- At least one model selected. -->
  <div *ngIf="model.numSelections > 0"
    fxLayout="column"
    fxFlex>
    <div class="spi-header"
      fxFlex="none">
      <md-icon class="spi-selection-icon"
        svgIcon="{{model.icon}}">
      </md-icon>
      <div class="spi-selection-description-container"
        fxLayout="column"
        fxFlex>
        <span class="spi-selection-description">{{model.description}}</span>
        <span class="spi-selection-sub-description">{{model.subDescription}}</span>
      </div>
    </div>
    <div class="spi-body"
      fxLayout="column"
      fxFlex>
      <div class="spi-empty"
        *ngIf="!model.inspectedProperties.length"
        fxFlex>
        No shared properties to view or edit
      </div>
      <form>
        <div class="spi-property"
          *ngFor="let ip of model.inspectedProperties; trackBy: trackInspectedPropertyFn">
          <div class="spi-property-name">{{ip.propertyName}}</div>
          <div class="spi-property-value"
            fxLayout="row">
            <div *ngIf="ip.typeName === 'ColorProperty'"
              class="spi-property-color-preview"
              [style.background-color]="this.androidToCssColor(ip.value)">
            </div>
            <span *ngIf="!ip.isEditable()"
              class="spi-property-value-static"
              fxFlex>
              <!-- Only show text if the property isn't inspectable. -->
              {{ip.getDisplayValue()}}
            </span>
            <div *ngIf="ip.isEditable()"
              class="spi-property-value-editor"
              fxLayout="column"
              fxFlex>
              <input (keydown)="this.valueEditorKeyDown($event, ip)"
                (blur)="ip.resolveEnteredValue()"
                name="{{ip.propertyName}}"
                [(ngModel)]="ip.editableValue"
                required="ip.propertyName === 'NameProperty' ? '' : undefined"
                *ngIf="ip.typeName === 'NameProperty'
                  || ip.typeName === 'PathProperty'
                  || ip.typeName === 'ColorProperty'
                  || ip.typeName === 'NumberProperty'
                  || ip.typeName === 'FractionProperty'">
              <ng-container *ngIf="ip.typeName === 'EnumProperty'">
                <md-menu #enumMenu="mdMenu">
                  <button md-menu-item
                    *ngFor="let option of ip.property.options; trackBy: trackEnumOptionFn"
                    (click)="ip.value = option.value;">
                    {{option.label}}
                  </button>
                </md-menu>
                <button class="spi-property-value-menu-target"
                  [mdMenuTriggerFor]="enumMenu">
                  <span class="spi-property-value-menu-current-value">
                    {{ip.getDisplayValue()}}
                  </span>
                </button>
              </ng-container>
            </div>
          </div>
        </div>
      </form>
    </div>
    <span *ngIf="this.shouldShowInvalidPathAnimationBlockMsg(model)">
      Customize the animation below to make the paths are compatible.
    </span>
    <button md-icon-button
      *ngIf="this.shouldShowEditPathMorphButton(model)"
      (click)="this.onEditPathMorphClick(model.model.id)"
      mdTooltip="Customize path morphing animation"
      mdTooltipPosition="below"
      mdTooltipShowDelay="500">
      <md-icon>edit</md-icon>
    </button>
    <md-menu #addTimelineBlockMenu="mdMenu">
      <button md-menu-item
        *ngFor="let propertyName of model.availablePropertyNames"
        (click)="this.onAnimateLayerClick(model.model, propertyName)">
        {{propertyName}}
      </button>
    </md-menu>
    <button md-icon-button
      *ngIf="this.shouldShowAnimateLayerButton(model)"
      mdTooltip="Animate this layer"
      mdTooltipPosition="below"
      mdTooltipShowDelay="500"
      [mdMenuTriggerFor]="addTimelineBlockMenu">
      <md-icon svgIcon="animationblock"></md-icon>
    </button>
  </div>
</ng-container>
